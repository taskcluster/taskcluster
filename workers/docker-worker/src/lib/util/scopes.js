const scopeUtils = require('../scopes');

/**
 * Do the expandedScopes satisfy all of the scopes for the given resources?
 *
 * The required scopes are generated by adding the prefix to each resource.
 * The `resources` can be an array or an object, in which case the iteration is
 * over the keys.
 *
 * @param {string} prefix
 * @param {object or array} resources
 * @param {array} expandedScopes
 */
module.exports = {
  async hasPrefixedScopes(prefix, resources, expandedScopes=[]) {
    let neededScopes = Object.keys(resources).map((r) => { return prefix + r; });

    return scopeUtils.scopeMatch(expandedScopes, [neededScopes]);
  }
};
