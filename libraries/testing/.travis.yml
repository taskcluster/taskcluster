env:
  global:
  - CXX=g++-4.8
  - DEBUG='* -superagent -express:* -mocha:* -babel'
language: node_js
addons:
  apt:
    sources:
    - ubuntu-toolchain-r-test
    packages:
    - g++-4.8
node_js:
- '0.12'
- '4'
- '5'
- '6'
script: npm test
before_install:
- openssl aes-256-cbc -K $encrypted_f6dcbce4fb59_key -iv $encrypted_f6dcbce4fb59_iv
  -in taskcluster-base-test.conf.json.enc -out taskcluster-base-test.conf.json -d

# encrpyt channel name to get around issue
# https://github.com/travis-ci/travis-ci/issues/1094
notifications:
  irc:
    channels:
      # encrpyted string was "irc.mozilla.org#taskcluster-bots"
      - secure: "XkfA/4QCL3QYFN72a6PD8zI/zqupcEpVIhJPw4jkGG/gVaZddgTEH+rW9ZJEgYTM3tJzvt5t7HWLJti3+I3QZK+eVSWm6X1EtkfGMHg6pNnxu9LHu49TK1IVuZl7mtjjDJh24x+vyJfTNXKSnrO403WjEKdbMAR3vTawm5jZpN+5xKDbgDDkvHW9FgqK1oqustwgdO7+xl3Y7961dac3agHhHKglrqdGVP4iJgfIxcLtCDRZ9b19vodQxAgWHOMn6xJTQvC28vwcGIFtACNkxdrr35BpQQypw+Gl+Zf3CYCwBp4YYWwZ/25i0/xuJIJC8yt2JEq8ZdtK9u5C2T+bazlkzR+IlWIFfRW69OCerrs5FkbmdFjXI1E/jGnoCTZbFeNBJbYDFccNFHBb4z2CDXVvG1Pzl+kvkT8sCIBdKBkX9Y7H5MyG7hcFbXrIGeX4I4wFusNwDGJmGtJfS3vPHqHYAt7taP2IsKMPz6fDWscDy5UDKPoJ6gzQe65dx6jJkK8adUpz5pIRK13mbxIELIH0+08YKwRA8movPenPszxgSCzHhj2ENCUtGUWELPQ92tHzhow67E/IV0qCyikzm9yZ242f/AxP/PsV1n1YuRjaFdVeuxvn6CDIFfKPhb8K4tCxd5N2YvXpgrscUU98M0kp9vChPCitwxOLR9ewTkc="
    on_success: change
    on_failure: always
    template:
      - "%{repository}#%{build_number} (%{branch} - %{commit} : %{author}): %{message}"
      - "Change view : %{compare_url}"
      - "Build details : %{build_url}"
      - "Commit message : %{commit_message}"
deploy:
  provider: npm
  email: taskcluster-accounts@mozilla.com
  api_key:
    secure: uNxHl6FaIym+nko0UNwdRLNPiaMzAswJlY4u3ixCaJUWRqAeZY3gpCRQDJDU8Suo34znke0L4HXbodnQsonJfjLpkR0ro5gdUVf7YsvzYZn1BoQFCJAdr6/Bama0XIXHGfV1gre5dBV/i8zHgp3RWZLBgCpqij+N7gzpx/OM33vTPDzy9rQJK43qRRlvoKdGRKwfZnct7m7CvmN5zSjB0iWN7LqQbMmyDopJB+RgZiwkQzK/rt6kCc2Y44FULF6PcmeAl5qss5ZuXYGDTBrK9vWtC0UHZQuhi6ypbT2q97dvzLcHlyNMicf7MDt0IKoFVDa2T0BvIFbteAJGM+IwzhAxy9LGCcGjygAjCFnQod/hSXpiTkPRcy5UgZyT4SXqKd8vgX5f/FBNQqMalS60j4sHk7hJOCo4uGbxC1gPZEpD/Kx8tc0dvJNLLQLF/s0/Ur4Pe48VT2bgU3nB1MDM83MHHfnRLBnH63IB/OivXdlWPMIxk9i9CIE2S+UrsL+x9uSf8twbHwJuPzLJn8C8+x12z7dEGQNLvda7vxuwXD2CoQ+agjbNi9cv78iz7gBlgXmhbuZSH+2SY6ikCbThbhQJSY8KCORlqdAg68947SKIFWoE7RR163KKtGCvYTsKQsymu1Ufk0YkMuV81PcFk/cFhQPoj7NoAPPvQUKVtlQ=
  on:
    tags: true
    repo: taskcluster/taskcluster-lib-testing
